<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Big Basket Cart</title>
    <link rel="stylesheet" href="cart.css">
    <link rel="stylesheet" href="navbarNew.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="footer.css">
    <style>
        #bbLogoAndSearchbar > div > input{
            width: 600px;
        }
        @media screen and (max-width: 1060px) {
            #staticHeader{
                font-family: ProximaNova-Regular;
                position: initial;
                top: 0px;;
                background: white;
                z-index:0;
            }
            #bbLogoAndSearchbar > div > input{
                width: auto;
            }
        }
        @media screen and (max-width: 800px) {
            #bbLogoAndSearchbar > #div1{
                display: none;
            }
            #homePageAddresBar , #homepageDropdown, #imagePay{
                display: none;
            }
            #bbLogoAndSearchbar > img, #cartBasket{
                margin: 5px;
            }
        }
        
        @media screen and (max-width: 430px) {
            #bbLogoAndSearchbar > img{
                margin-left: -30px;
            }
            footer{
                display: none;
            }
        }
        @media screen and (max-width: 330px) {
            #bbLogoAndSearchbar > img{
                width: 50%;
            }
        }
    </style>

</head>
<body>
    <!-- Navbar Goes here -->
    <div id="staticHeader">
        <div id="homePageAddresBar">
          <p>
            <img
              src="data:image/png;base64,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"><span
              id="helpLineNum">1860 123 1000</span>
          </p>
    
          <p>
            <img
              src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRyeRKuT1Dx5i2BHXApLE2W_JwPK9dXLzzBPA&usqp=CAU"><span
              ><span>560004, Bangalore</span>
          </p>
    
          <p>
            <a id="userLogin" style="background-color: white;" href="signin.html">Login/Sign Up</a>
          </p>
        </div>
        <!-- end of homepage addresbar -->
    
        <!-- start of bbLogoAndSearchbar  -->
        <div id="bbLogoAndSearchbar">
          <img src="https://www.bbassets.com/static/staticContent/bb_logo.png" alt="bigbasketLogo">
          
          <div id="div1" style="margin-top: 10px">
            <input style="height: 30px;" type="text" placeholder="Search for Products..."></input>
            <i style="margin-left: -5px; background-color: #84c225; color: white; padding: 10px;" class="fa fa-search"></i>
          </div>
          <div id="cartBasket" class="tooltip">
            <a style="background-color: whitesmoke;" href="cart.html">
              <img style="margin-top: -15px;" src="https://www.crushpixel.com/big-static18/preview4/shopping-basket-3116850.jpg" alt="basketImage">
            </a>
            <div id="basketItems">
              <p>My Basket </p>
              <span id="totaItems"></span>
              <!-- <span class="tooltiptext">Your basket is empty. Start shopping now.</span> -->
            </div>
          </div>
        </div>
        <!-- end of bbLogoAndSearchbar -->
    
        <!-- start of shop by category dropdown -->
        <div id="homepageDropdown">
          <div class="dropdown">
            <button style="height: 36px; width: 250px; font-size: medium;padding: 0px 10px;" class="dropbtn">SHOP BY CATEGORY</button>
            <div class="dropdown-content">
              <a style="background-color: white;" href="eggMeatFish.html">Fruits & Vegetables</a>
              <a style="background-color: white;" href="ayurveda.html">Foodgrains, Oil & Masala</a>
              <a style="background-color: white;" href="buyMoreSaveMore.html">Bakery, Cakes & Dairy</a>
              <a style="background-color: white;" href="dealsofTheWeek.html">Baverages</a>
              <a style="background-color: white;" href="comboStore.html">Snacks & Branded Foods</a>
              <a style="background-color: white;" href="ayurveda.html">Beauty & Hygiene</a>
              <a style="background-color: white;" href="eggMeatFish.html">Cleaning & Household</a>
              <a style="background-color: white;" href="buyMoreSaveMore.html">Kitchen, Garden & Pets</a>
              <a style="background-color: white;" href="dealsofTheWeek.html">Eggs, Meat & Fish</a>
              <a style="background-color: white;" href="comboStore.html">Gourmet & World Food</a>
              <a style="background-color: white;" href="eggMeatFish.html">Baby Care</a>
            </div>
          </div>
          <div style="color: green; font-weight: 600;"><a style=" background-color: white;" href="#"><i style="color:red;margin-right: 4px;" class="fa fa-tag"></i>OFFERS</a></div>
        </div>
    </div>

    <!-- Cart Goes here -->
    <div id="cart">
        <div id="empty-cart">
            <h1>OOPs... Empty! <i class="fa fa-ship" style="font-size:28px;"></i></h1>
            <div>
                <i class="fa fa-shopping-cart" style="font-size:120px; color: green;"></i>
            </div>
            <div style="margin: 40px auto;">
                <h2>Your cart appears to be empty!</h2>
                <h3>Try Fresh Groceries Today!</h3>
            </div>
            <div>
                <button class="btn2"><a href="index.html">Add Items</a></button>
            </div>
        </div>
        <div id="parent">
            <div id="t-head">
                <div>
                    <h2>Item Description</h2>
                </div>
                <div>
                    <div id="t-head2">
                        <h2>Quantity</h2>
                    </div>
                    <div>
                        <h2>Cost / Savings</h2>
                    </div>
                </div>
            </div>

            <!-- Added via Javascript -->
        </div>
        <div id="parent-2">
            <div id="add-remove">
                <div>
                    <h1>Your Basket (<span id="span-items">4 items</span>)</h1>
                    <div style="display: flex; justify-content: space-around;">
                        <button onclick="clearCart()">Empty Cart</button>
                        <button><a href="index.html">Add Items</a></button>
                    </div>
                </div>
            </div>
            <div id="cart-total">
                <div>
                    <h1>Order Summary</h1>
                    <hr style="width: 90%;">
                    <div>
                        <span style="font-size: 18px; color:rgb(122, 122, 123)">!Promo Code Available!<i class="fa fa-tag"></i></span>
                        <input id="promo-code" type="text" placeholder=" Enter Coupon Code!!">
                        <button id="apply-promo">Apply</button>
                        <div>
                            <p id="code">No Promo Code Applied!</p>
                        </div>
                    </div>
                    <hr style="width: 90%;">
                </div>
            </div>
        </div>
    </div>

    <div id="myFooter">
        <footer class="footer">
            <div class = "container">
                <hr>
                <div id = "whole-table">
                    <table>
                        <tr>
                            <td class = "heading"><div class="properties">POPULAR CATEGORIES:</div></td>
                            <td >Sunflower Oils, Wheat Atta, Ghee, Milk, Health Drinks, Flakes, Organic F&V, Namkeen, Eggs, Floor Cleaners, Other Juices, Leafy Vegetables, Frozen Veg Food, Diapers & Wipes,</td>
                        </tr>
                    </table>
                    <table>
                        <tr>
                            <td class = "heading"><div class="properties">POPULAR BRANDS:</td>
                            <td>
                                Amul, Nescafe , MTR, RED BULL , elite cake, Pediasure, Yummiez, Yera, Yakult, Britannia, Wow Momo, Fortune , Haldirams , Ferrero, Lays, Patanjali, McCain, kwality walls, Cadbury Dairy Milk, Pedigree,</td>
                        </tr>
                    </table>
                    <table>
                        <tr>
                            <td class = "heading"><div class="properties">CITIES WE SERVE:</td>
                            <td>
                                Bangalore, Hyderabad, Mumbai, Pune, Chennai, Delhi, Mysore, Madurai, Coimbatore, Vijayawada-Guntur, Kolkata, Ahmedabad-Gandhinagar, Nashik Business, Lucknow-Kanpur, Gurgaon, Vadodara, Visakhapatnam, Surat, Nagpur, Patna, Indore, Chandigarh Tricity, Jaipur,
                                Bhopal, Noida-Ghaziabad, Kochi, Krishna District, Bhubaneshwar-Cuttack, Guwahati, Renigunta, Hubli, Davanagere, Trichy, Amravati, Raipur, Rajkot, Gwalior, Bareilly, Allahabad, Hyderabad Rural, Bangalore Rural, Chennai Rural, Vizag Rural, Lucknow Rural, Noida Rural, Ahmedabad Rural, Bhopal Rural, Bhubaneswar Rural, Coimbatore Rural, Chandigarh Rural, Gurugram Rural, Guwahati Rural, Indore Rural, 
                                Kochi Rural, Kolkata Rural, Mumbai Rural, Mysore Rural, Nagpur Rural, Patna Rural, Pune Rural, Surat Rural, Vadodara Rural, Jaipur Rural, Ranchi, Nashik, Agra, Kozhikode, Amritsar, </td>
                        </tr>
                    </table>
                    <table id="imagePay">
                        <tr>
                            <td class = "heading"><div class="properties">PAYMENT OPTIONS:</div></td>
                            <td> <img class = "size" src = "card_img.png"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </footer>
    </div>
</body>
</html>
<script>
    var cartItems = JSON.parse(localStorage.getItem("cartItems")) || [];
    
    var users = JSON.parse(localStorage.getItem('users')) || [];
    var userLogin = document.getElementById('userLogin');
    
    if(users.length > 0){
        userLogin.textContent = users[users.length-1].name;
    }
    
    var totalItems = document.getElementById('span-items');
    totalItems.textContent = cartItems.length + " items";
    
    document.getElementById('totaItems').textContent = cartItems.length + " Items";
    
    var cartDiv = document.getElementById('parent');
    var cartTotal = localStorage.getItem('cartTotal') || 0;
    
    var emptyCart = document.getElementById('empty-cart');
    var emptyImage = document.createElement('img');
    
    if(cartItems.length > 0){
        emptyCart.style.display = "none";
        document.getElementById('parent').style.display="initial";
        document.getElementById('parent-2').style.display="initial";
    }
    else{
        document.querySelector("#cart").setAttribute("style", " align-items:center; height: 80vh;background-image: url('https://img.freepik.com/free-vector/geometric-frame-background-green-modern-design-vector_53876-157567.jpg?size=626&ext=jpg&ga=GA1.2.232835331.1679132289&semt=ais'); background-repeat: no-repeat; background-attachment: fixed; background-size: 100% 100%;")
        document.getElementById('parent').style.display="none";
        document.getElementById('parent-2').style.display="none";
    }
    
    display();
    function display(){
        
        cartItems.map((elem,idx)=>{
            var div = document.createElement('div');
            
            var leftdiv = document.createElement('div');
            leftdiv.setAttribute('id','leftdiv');
            
            var img = document.createElement('img');
            img.setAttribute('src',elem.image_url);
            
            var infoDiv = document.createElement('div');
            var brand = document.createElement('p');
            brand.textContent = elem.brand;
        brand.style.fontSize = "18px"
        brand.style.color = "rgb(170, 170, 170)"
        var name = document.createElement('p');
        name.textContent = elem.name;
        var price = document.createElement('p');
        price.textContent = "Rs." + elem.price;
        price.style.fontSize = "18px"
        price.style.color = "rgb(170, 170, 170)"
        
        infoDiv.append(name, brand, price);
        leftdiv.append(img, infoDiv);
        
        var rightdiv = document.createElement('div');
        rightdiv.setAttribute('id','rightdiv');
        
        var quantityDiv = document.createElement('div');
        var btn1  = document.createElement('button');
        btn1.textContent = " - "
        var quantity = document.createElement('span');
        quantity.style.fontSize = "x-large";
        quantity.style.margin = "0px 10px";
        quantity.textContent = elem.quantity
        var btn2  = document.createElement('button');
        btn2.textContent = " + ";
        
        quantityDiv.append(btn1, quantity, btn2);
        
        btn1.addEventListener('click', function(){
            decQuantity(elem,itemPrice,subTotal,quantity);
        });
        btn2.addEventListener('click', function(){
            incQuantity(elem,itemPrice,subTotal,quantity);
        });
        
        var costDiv = document.createElement('div');
        
        var subTotal = document.createElement('p');
        subTotal.textContent = "Cost - Rs." + (elem.price * elem.quantity);
        var itemPrice = document.createElement('p');
        itemPrice.textContent = "Saved - Rs." + (elem.price * elem.quantity) * 25/100;
        itemPrice.style.fontSize = "16px"
        itemPrice.style.color = "green"
        
        var span = document.createElement("span");
        span.textContent = " X ";
        span.style.color = "white";
        span.style.border = "1px solid white";
        span.style.padding = "3px";
        span.style.backgroundColor = "green";
        
        span.addEventListener('click', function(){
            handleDelete(idx);
        })
        
        
        costDiv.append(subTotal, itemPrice);
        rightdiv.append(quantityDiv, costDiv,span);
        
        div.append(leftdiv, rightdiv);
        cartDiv.append(div);
    })
    
}

    var totalDiv = document.createElement('div');
    totalDiv.setAttribute('class','cart-2')
    var totalheading = document.createElement('p');
    totalheading.textContent = "Total Cart Value";
    var total = document.createElement('p');
    total.textContent = "Rs." + cartTotal;
    var tax = document.createElement('p');
    tax.textContent = "Total Tax";
    var totalTax = document.createElement("p");
    totalTax.textContent = "Rs." + cartTotal * (12/100);
    var deliveryCharges = document.createElement('p');
    deliveryCharges.textContent = `Delivery Charges`;
    var totalDelCharge = document.createElement("p");
    totalDelCharge.textContent = `Rs. ${cartTotal>=500 ? 0 : 40}`;
    var saved = document.createElement('p');
    saved.textContent = `Savings`;
    var totalsaved = document.createElement("p");
    totalsaved.textContent = `Rs. 0`;

    var hr=document.createElement("hr");
    hr.style.width = "90%"
    
    var tcv = document.createElement("div");
    tcv.setAttribute("class","tcv");
    tcv.setAttribute("id","tsc");
    tcv.append(totalheading,total);
    var tt = document.createElement("div");
    tt.setAttribute("class","tcv");
    tt.append(tax,totalTax);
    var dc = document.createElement("div");
    dc.setAttribute("class","tcv");
    dc.append(deliveryCharges,totalDelCharge);
    var ts = document.createElement("div");
    ts.setAttribute("class","tcv");
    ts.append(saved,totalsaved);
    
    totalDiv.append(tcv,tt,dc,ts);
    

    var payingTotal = document.createElement('h2');
    payingTotal.textContent = "Sub Total : Rs. " + (parseInt(cartTotal) + cartTotal * (12/100));
    
    var checkoutBtn = document.createElement('button');
    checkoutBtn.innerHTML = "<a href='\payment.html'>Checkout Now</a>";
    checkoutBtn.setAttribute('id','checkbtn');    

    document.getElementById('cart-total').append(totalDiv,hr,payingTotal,checkoutBtn);

    var applyPromo = document.getElementById('apply-promo');
    applyPromo.addEventListener('click', promoCodeFun);

    var offers = ["BASKET200","FIRST","SHOP5"];
    function promoCodeFun(){
        var promoCode = document.getElementById('promo-code').value;
        console.log(promoCode)
        if(offers.includes(promoCode)){
            document.getElementById('code').textContent = "Hurray! You get 30% discount.";
            payingTotal.textContent = "Sub Total : Rs. " + (parseInt(cartTotal) + cartTotal * (12/100) - cartTotal*(30/100));
            document.getElementById('code').style.color = "green"
        }
        else{
            document.getElementById('code').textContent = "Not a valid Promo Code";
            document.getElementById('code').style.color = "red"
        } 
    }

    function decQuantity(item, itemPrice, subTotal, qnt){
        if(item.quantity > 0){
            item.quantity--;
            qnt.textContent = item.quantity;
            subTotal.textContent = "Cost - Rs." + (item.price * item.quantity);
            itemPrice.textContent = "Saved - Rs." + (item.price * item.quantity) * 25/100;
            cartTotal -= item.price;
            total.textContent = "$ " + cartTotal;
            totalTax.textContent = "Rs." + cartTotal * (12/100);
            totalDelCharge.textContent = `Rs. ${cartTotal>=500 ? 0 : 40}`;
            payingTotal.textContent = "Sub Total : Rs. " + (parseInt(cartTotal) + cartTotal * (12/100));
            localStorage.setItem('cartItems',JSON.stringify(cartItems));
            localStorage.setItem('cartTotal',cartTotal);
            console.log(cartTotal);

            if(cartTotal>=5000){
                payingTotal.textContent = "Sub Total : Rs. " + (parseInt(cartTotal) + cartTotal * (12/100) - cartTotal*(30/100));
            }
            if(cartTotal>=10000){
                payingTotal.textContent = "Sub Total : Rs. " + (parseInt(cartTotal) + cartTotal * (12/100) - cartTotal*(40/100));
            }
        }
    }
    let countAlert = 0;
    function incQuantity(item, itemPrice, subTotal, qnt){
        item.quantity++;
        qnt.textContent = item.quantity;
        subTotal.textContent = "Cost - Rs." + (item.price * item.quantity);
        itemPrice.textContent = "Saved - Rs." + (item.price * item.quantity) * 25/100;
        cartTotal = parseInt(cartTotal) + item.price;
        total.textContent = "$ " + cartTotal;
        totalDelCharge.textContent = `Rs. ${cartTotal>=500 ? 0 : 40}`;
        payingTotal.textContent = "Sub Total : Rs. " + (parseInt(cartTotal) + cartTotal * (12/100));
        totalTax.textContent = "Rs." + cartTotal * (12/100);
        localStorage.setItem('cartTotal',cartTotal);
        localStorage.setItem('cartItems',JSON.stringify(cartItems));
        console.log(item);
        if(cartTotal>=5000){
            payingTotal.textContent = "Sub Total : Rs. " + (parseInt(cartTotal) + cartTotal * (12/100) - cartTotal*(30/100));
        }
        if(cartTotal>=10000){
            payingTotal.textContent = "Sub Total : Rs. " + (parseInt(cartTotal) + cartTotal * (12/100) - cartTotal*(40/100));
        }
        if(cartTotal >= 3500 && cartTotal < 5000 && countAlert == 0){
            countAlert++;
            alert(`Shop a total of R.5000 and get assured 30% Discount...`);
        }
        else if(cartTotal >= 7500 && cartTotal < 10000 && countAlert == 1){
            countAlert++;
            alert(`Shop a total of R.10000 and more and get assured 40% Discount...`);
            payingTotal.textContent = "Sub Total : Rs. " + (parseInt(cartTotal) + cartTotal * (12/100) - cartTotal*(40/100));
        }
    }

    function clearCart(){
        cartItems = [];
        localStorage.setItem("cartItems",JSON.stringify(cartItems));
        localStorage.setItem("cartTotal",0);
        emptyCart.style.display = "initial";
        document.querySelector("#cart").setAttribute("style", " align-items:center; height: 80vh;background-image: url('https://img.freepik.com/free-vector/geometric-frame-background-green-modern-design-vector_53876-157567.jpg?size=626&ext=jpg&ga=GA1.2.232835331.1679132289&semt=ais'); background-repeat: no-repeat; background-attachment: fixed; background-size: 100% 100%;")
        document.getElementById('parent').style.display="none";
        document.getElementById('parent-2').style.display="none";      
    }

    function handleDelete(index){
        cartItems.splice(index,1);
        display();
    }

</script>